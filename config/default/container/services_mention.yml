services:
# ----- Controller -----
    phpbb.mention.controller:
        class: phpbb\mention\controller\mention
        arguments:
            - '@phpbb.mention.source_collection'
            - '@request'
            - '%core.root_path%'
            - '%core.php_ext%'

# ----- Sources for mention -----
    phpbb.mention.source_collection:
        class: phpbb\di\service_collection
        arguments:
            - '@service_container'
        tags:
            - { name: service_collection, tag: mention.source }

    phpbb.mention.source.base_group:
        abstract: true
        arguments:
            - '@dbal.conn'
            - '@group_helper'
            - '@user'
            - '@auth'
            - '%core.root_path%'
            - '%core.php_ext%'

    phpbb.mention.source.base_user:
        abstract: true
        arguments:
            - '@dbal.conn'
            - '@user_loader'
            - '%core.root_path%'
            - '%core.php_ext%'

    phpbb.mention.source.friend:
        class: phpbb\mention\source\friend
        parent: phpbb.mention.source.base_user
        calls:
            - [set_user, ['@user']]
        tags:
            - { name: mention.source }

    phpbb.mention.source.group:
        class: phpbb\mention\source\group
        parent: phpbb.mention.source.base_group
        tags:
            - { name: mention.source }

    phpbb.mention.source.team:
        class: phpbb\mention\source\team
        parent: phpbb.mention.source.base_user
        tags:
            - { name: mention.source }

    phpbb.mention.source.topic:
        class: phpbb\mention\source\topic
        parent: phpbb.mention.source.base_user
        tags:
            - { name: mention.source }

    phpbb.mention.source.user:
        class: phpbb\mention\source\user
        parent: phpbb.mention.source.base_user
        tags:
            - { name: mention.source }

    phpbb.mention.source.usergroup:
        class: phpbb\mention\source\usergroup
        parent: phpbb.mention.source.base_group
        tags:
            - { name: mention.source }
